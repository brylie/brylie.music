---
import { Image } from 'astro:assets';
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import FormattedDate from '../../components/FormattedDate.astro';
import { SITE_DESCRIPTION, SITE_TITLE } from '../../consts';

const posts = (await getCollection('blog')).sort(
	(a, b) => (b.data.pubDate?.valueOf() || 0) - (a.data.pubDate?.valueOf() || 0),
);
---

<Layout title={`Blog - ${SITE_TITLE}`} description={SITE_DESCRIPTION}>
	<div class="max-w-6xl mx-auto px-4 py-12">
		<div class="text-center mb-12">
			<h1 class="text-4xl md:text-5xl font-bold text-white mb-4">Blog</h1>
			<p class="text-xl text-gray-300">Latest posts and updates</p>
		</div>

		<div class="grid gap-8 md:grid-cols-2 lg:grid-cols-3">
			{posts.map((post, index) => (
				<article class={`
					group bg-gray-900 rounded-lg shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden
					${index === 0 ? 'md:col-span-2 lg:col-span-3' : ''}
				`}>
					<a href={`/blog/${post.id}/`} class="block">
						{post.data.heroImage && (
							<div class="aspect-video overflow-hidden">
								<Image 
									width={index === 0 ? 1200 : 600} 
									height={index === 0 ? 600 : 300} 
									src={post.data.heroImage} 
									alt=""
									class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
								/>
							</div>
						)}
						<div class="p-6">
							<h2 class={`
								font-bold text-white group-hover:text-blue-400 transition-colors mb-3 leading-tight
								${index === 0 ? 'text-2xl lg:text-3xl' : 'text-xl'}
							`}>
								{post.data.title}
							</h2>
							<p class="text-gray-400 text-sm">
								<FormattedDate date={post.data.pubDate!} />
							</p>
							{post.data.description && (
								<p class="text-gray-300 mt-3 line-clamp-3">
									{post.data.description}
								</p>
							)}
						</div>
					</a>
				</article>
			))}
		</div>

		{posts.length === 0 && (
			<div class="text-center py-12">
				<p class="text-gray-400 text-lg">No blog posts found. Start by adding some content!</p>
			</div>
		)}
	</div>
</Layout>
